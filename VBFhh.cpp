// The cross sections for Higgs pair production via VBF at 10 Tev muon colliders, up to the linear order in SMEFT Wilson coefficients.
// The Higgs are assumed to decay into bb with fixed branching fraction 0.58.
// The dim-6 SMEFT operators considered are: 
//		1.  OH  = \left(H^\dagger H\right)^3
//		2.  OHbox = \left(H^\dagger H\right)\Box \left(H^\dagger H\right)
//		3.  OHD  = \left(D^\mu H^\dagger H\right) \left(H^\dagger D_\mu H\right)
//		4.  OHW  = \left(H^\dagger H\right) W^i_{\mu\nu} W^{i\mu\nu}
//		5.  OHB  = \left(H^\dagger H\right) B_{\mu\nu} B^{\mu\nu}
//		6.  OHWB = \left(H^\dagger \sigma^i H\right) W^i_{\mu\nu} B^{\mu\nu}
//----------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------
// calc_xsec_hh compute cross sections (in unit of fb) for hh final states, with arguments:
//      i_channel (0-5) specify the final state: 0 - WW fusion to vvhh,  1 - ZZ fusion to mumuhh with at least one eta_mu < 6
//      i_mhh (0-5) specify the hh invariant mass: 0 - [0, 400],  1 - [400, 700],  2 - [700, 1130],  3 - [1130, 2500],  4 - [2500, 5000],  5 - [5000, infinity]
//      i_pth (0-5) specify the transverse momentum of the softer Higgs: 0 - [0, 100],  1 - [100, 300],  2 - [300, 500],  3 - [500, 700],  4 - [700, 1000],  5 - [1000, inf]
//      cH, cHbox, cHD, cHW, cHB, cHWB are the corresponding Wilson coefficients for the SMEFT operators OH, OHbox, OHD, OHW, OHB, OHWB
//      LambdaEFT is the SMEFT cutoff scale in unit of TeV.
//
//      Kinematic cuts are:
//         p_{T,b} > 10 GeV
//         10^\circ < \theta_b < 170^\circ


extern double xsec_list_hh[2][6][6][7] = {{{{0.03430787450310972, 0.8091162599570473, -0.3763985231039304, -0.03059299393477128, -0.5122832163327541, 8.690084984408472e-05, -0.27535567368704456}, {0.009510003954451157, 0.28455620007210136, -0.10086551133152942, -0.117968616712845, -1.5009761489512805, 0.0009624172330869403, -0.31619772464185786}, {0.0007267072122000086, -0.9415086139098942, 0.8953621059506558, -0.3501041352162615, -2.7302437168335514, 0.009834221811926589, -0.2788199933683468}, {0.00017829991080000045, -0.9668417624661176, 0.9301877900604394, -0.36216787610779083, -2.3435132307648243, 0.042679213693169765, -0.28623401870851645}, {5.808254669999987e-05, -0.9708751286323097, 0.9255775281149541, -0.3606350132496232, 2.505943838052708, 0.0337123647730967, -0.28540243051649367}, {1.4858325900000001e-05, -0.9235629970935643, 0.8811692574324947, -0.3511431930577537, -11.72741809358184, 0.11471682687836258, -0.28894237674573175}}, {{0.04907502431230206, 0.2587564848053323, -0.15636673294333206, -0.08220349714667986, -0.27146304072735716, 0.00012958097367915208, -0.26784475614595793}, {0.04587170432396457, 0.5789047004687001, -0.7770347444444199, 0.037566455735590414, -0.8664285104871627, 0.0003311657063530891, -0.34603672308971706}, {0.0008482753332000104, 0.08718489976640019, -0.1842314564594417, -0.11442405113671875, -12.701687858172068, 0.009862010107363331, -0.35443114793630626}, {9.928063214999968e-05, -0.5089270575960638, 0.9836268956818608, -0.389332734489614, -25.876546556588476, 0.09006590519964898, -0.31670628314397853}, {2.7015138000000002e-05, -0.701632543948448, 1.387792281494818, -0.4843987841206089, -28.6513139410942, 0.05037175823263712, -0.3035039095504935}, {6.078406050000001e-06, -0.7158126594700001, 1.1175462685649016, -0.41802077371928503, -54.538508495992275, 0.008275195764981726, -0.30616579160682017}}, {{0.01765979571061022, 0.08285620754869168, -0.08785169022859277, -0.10572307473855345, -0.20854643861676123, 0.00039201405913036504, -0.28195414513534517}, {0.035886233940753555, 0.2233325729809082, -0.6820456521139224, 0.01345285680275502, -0.326036684562928, 0.00025814334866156735, -0.346841316782273}, {0.006649100840249204, 0.7115743799992987, -3.158736165418159, 0.6113734782748447, -3.3923511214741198, 0.0006596385818324542, -0.39411498711797033}, {0.0002951403826500022, 0.37591467145778923, -2.2883727193127794, 0.401482165592004, -27.660646864798053, 0.010242583378719652, -0.3771676346856238}, {3.039203025e-05, -0.08182079247906841, 0.5481404125669341, -0.29949627995321954, -73.84310562799512, -0.0497400136693158, -0.35881117221464653}, {6.078406050000001e-06, -0.04932214095825577, 0.32924750066607755, -0.2463474778884207, -122.7117757294276, -0.6624269531979362, -0.3625950589449674}}, {{0.0027406857500997584, 0.03688153682623986, -0.10354470502266026, -0.11638492214275149, -0.6531895886144874, 0.03589320693197405, -0.3065957479696357}, {0.015795075810158148, 0.08952505420422165, -0.7408248508046784, 0.021388812720770617, -0.13580278478967858, 0.0026437973387391607, -0.36175718622266445}, {0.007735784766299184, 0.2662034777820528, -3.0073498416260347, 0.5773452006828753, -0.3499741103342977, 0.002617730840287972, -0.38562040982344475}, {0.0033019252420496787, 0.5045307149775957, -6.532576214037716, 1.4559750299521035, -4.331090908645811, -0.000481717971253942, -0.39270419578579585}, {0.001229864157449973, 0.5436998844400603, -10.79757485350895, 2.5243776570390537, -14.413579005741168, -0.0058421897239330925, -0.3912402819682409}, {0.0001816768030500005, 0.49438397466207157, -14.226350071201937, 3.386476917611999, -50.06521717305636, -0.31373900821312445, -0.38536345218992746}}, {{4.0522707e-06, 0.019199112241759592, -0.44619427818678586, -0.05389570839796753, 1.8581187086044726, -0.005182279653336681, -0.3653260380660331}, {0.0001546616650500001, 0.03407373118891033, -1.16397363201465, 0.10965225282442297, -0.8004950674815164, -0.0021808895036356368, -0.40050066694071973}, {0.0006375572568000072, 0.0856690114553111, -3.579427691753042, 0.7195355319537448, -0.28911646460449936, -0.0028441368104119014, -0.38742888961882216}, {0.000620672795550007, 0.15603309929574047, -7.481136813715814, 1.6978002056659283, -0.39710311429611456, 0.0036964725341062485, -0.3820985900719318}, {0.000549758058300006, 0.26299205214038057, -13.636380198305307, 3.235656982356754, 3.7080449648154676, -0.0035357372661998093, -0.38756576067733545}, {0.000619997417100007, 0.3731434898872194, -23.233572596881807, 5.649194179396641, -7.588913712070645, -0.09776879451890781, -0.37592866299988553}}, {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {6.078406050000001e-06, 0.06824157461394247, -10.205372837835698, 2.3782550690243474, -25.58787595310425, -0.012355212762685005, -0.38440998853753705}, {1.75598397e-05, 0.09013180228217, -15.87422805459816, 3.8100746443581945, 4.812897010673113, 0.032300978238919, -0.3548267015219904}, {7.631776484999979e-05, 0.13851558707249134, -24.22687959522907, 5.946315394510415, 11.773882552354971, -0.3317065174475955, -0.3475573485455024}}}, {{{0.004481512139378332, 0.765753031578107, -0.34153722581994866, -0.10504818888104199, -0.4145188333224101, -0.03888766293988263, -0.1984779680288907}, {0.0014377418408882212, 0.36200322121850653, -0.1411315970903389, -0.10904751308465323, -1.1968129348823893, -0.06926427910798444, -0.4866730746780017}, {9.815286838200238e-05, -0.9298246859985008, 0.8840786968940896, 0.07018307351738265, -1.627682437156966, 0.27489863944033166, -0.8905794753177788}, {2.2948175006999955e-05, -0.9514333925437232, 0.9106915906830731, 0.07792427938130804, -0.6038807005504225, 1.0138339974014363, -0.7732998373129429}, {9.626200751999989e-06, -0.9783724900920708, 0.936996872647795, 0.08410690998232773, 2.2402992162437214, 2.787072562818979, -0.10084248447863922}, {2.3206019670000007e-06, -0.8746265102191646, 0.8511584615016397, 0.06826676967517949, -11.26138405966817, 9.63324185616023, -12.98218325607632}}, {{0.006215861290934456, 0.25053384442641385, -0.14059269080785144, -0.13754503597972567, -0.2576865584423127, -0.004985414290693696, -0.14767339737939703}, {0.007400829413859491, 0.499724732059388, -0.6372562560836706, -0.32156956902669837, -0.5911094945695032, -0.051196192234313584, -0.290956789362175}, {0.00015075317963399938, 0.19871388502457674, -0.35025967692847587, -0.255666978873339, -8.46529494831498, -0.4556718482244392, -3.8873233812671613}, {1.5728524442999972e-05, -0.45489327531318796, 0.9136673978787896, 0.2079012568637227, -16.71360596809235, 1.6118377850449856, -9.379296865028422}, {3.953618166000003e-06, -0.49176979626996375, 1.038377968633312, 0.2610773111209724, -25.88062015699254, 4.036153550992574, -16.63578202003284}, {1.1173268729999998e-06, -0.7349952998045478, 1.523045798972063, 0.44108846919403827, -15.685579952928945, 36.881525895244685, -37.20736608471285}}, {{0.0022998884457389487, 0.07873517555425501, -0.07240230273024661, -0.14779133315914925, -0.20977972233097258, -0.013603594366888272, -0.1421136056366613}, {0.005803911467682139, 0.19327824087483753, -0.5544593277835937, -0.35926466731247064, -0.23639896617564068, 0.01323828755480938, -0.16573179780649985}, {0.001216854912918043, 0.5716503603885831, -2.4940944958233726, -1.2315169659807932, -2.074007807856801, -0.053340722587047425, -0.9445175659136704}, {5.1568932600000716e-05, 0.30579477212330036, -1.739894457454763, -0.9228967443630847, -17.2748142164778, -0.20747918306219523, -8.738043765656188}, {6.188271911999997e-06, -0.08630196080185648, 0.49300516257737514, 0.09373537689824324, -47.00482366262606, 10.925672136178381, -34.160266873542255}, {1.0313786519999998e-06, -0.19923817465037172, 0.9005809827459597, 0.2689506898982581, -98.15101350381542, 55.67543975110457, -91.67145336647697}}, {{0.0004055037066780207, 0.03349668463462212, -0.07552715229180107, -0.16102947797539044, -0.18257931800684107, 0.005758195919120506, -0.1287079485258188}, {0.002685881906249309, 0.07353954637456202, -0.565860255965996, -0.39586743579040223, -0.014720287298095082, 0.16693084527642607, -0.15189968410797366}, {0.0013950255750511868, 0.21135717039529298, -2.310576285846837, -1.2327359172132315, -0.2413443078072033, 0.3988789439003544, -0.27132707721859395}, {0.0006085134046799781, 0.425863453794824, -5.40722272423943, -2.726048377934757, -2.472303680125639, 0.9486752893039434, -1.3733907476282476}, {0.00023077097338498992, 0.4296562892812058, -8.467682963924414, -4.2561809897066585, -8.971423353328122, 2.913026409850369, -5.055645876011382}, {3.291816864300005e-05, 0.4117756411915435, -11.96088805153991, -6.008479151613066, -31.681570178176578, 8.968698811933061, -19.68337689217017}}, {{6.875857679999999e-07, 0.006413745319765172, -0.02593131043250961, -0.14324031209280003, -1.0227378644614833, 2.6981943000332382, -0.6752030388150141}, {2.810506826699994e-05, 0.02890226036637461, -0.9707195777017166, -0.6098270189770013, 0.3823833444726259, 5.703994328626697, 2.8357283904656487}, {0.00011998371651600302, 0.06605871362798654, -2.7116319570482483, -1.4707495746447912, -0.11759620755082204, 0.6479900958884866, -0.3173418121566384}, {0.0001070914833660027, 0.12327348131794925, -5.798589677814692, -2.9997233199975435, 1.1334060950445655, 3.062108018913573, -1.112250911876716}, {9.772312727700236e-05, 0.19512832334125588, -10.139427969953912, -5.1525076412731625, 0.5996324678747372, 5.060825351750112, -1.2590372765677673}, {0.00010812286201800273, 0.32266774408271964, -19.328679439489594, -9.72111670381647, -13.011194614785335, 29.445222689764663, -12.291584270187139}}, {{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {8.5948221e-08, 0.0017452368213876854, -0.006515550798143078, -0.1346159334702546, -0.12135213362951273, 0.5888429034507905, -0.7395150156742027}, {4.2974110499999997e-07, 0.044166126486714606, -6.430709019561305, -3.3361481676261784, -0.5199409537498634, -0.8519780764271618, -0.046493108915632526}, {4.297411050000002e-06, 0.0678199028659824, -11.822243534281691, -6.026893796915227, 13.00164200024069, 76.46329759401888, -37.43303308163214}, {1.4611197569999975e-05, 0.17441417707554854, -31.018094706368736, -15.622249915255015, 6.07225859312432, 134.49303389306118, 16.884507845327175}}}};

double calc_xsec_hh(int i_channel, int i_mhh, int i_pth, double cH, double cHbox, double cHD, double cHW, double cHB, double cHWB, double LambdaEFT /* in TeV */){
	// i_channel 0-1: 0 - WW fusion to vvhh,  1 - ZZ fusion to mumuhh with at least one eta_mu < 6
	// i_mhh 0-5: 0 - [0, 400],  1 - [400, 700],  2 - [700, 1130],  3 - [1130, 2500],  4 - [2500, 5000],  5 - [5000, infinity]   # hh pair invariant mass in GeV
	// i_pth 0-5: 0 - [0, 100],  1 - [100, 300],  2 - [300, 500],  3 - [500, 700],  4 - [700, 1000],  5 - [1000, inf]  # pt of the softer higgs
	return xsec_list_hh[i_channel][i_mhh][i_pth][0]*(1. + cH/LambdaEFT/LambdaEFT*xsec_list_hh[i_channel][i_mhh][i_pth][1] + cHbox/LambdaEFT/LambdaEFT*xsec_list_hh[i_channel][i_mhh][i_pth][2]  + cHD/LambdaEFT/LambdaEFT*xsec_list_hh[i_channel][i_mhh][i_pth][3] + cHW/LambdaEFT/LambdaEFT*xsec_list_hh[i_channel][i_mhh][i_pth][4] + CHB/LambdaEFT/LambdaEFT*xsec_list_hh[i_channel][i_mhh][i_pth][5] + CHWB/LambdaEFT/LambdaEFT*xsec_list_hh[i_channel][i_mhh][i_pth][6]);
	// unit fb
}



